@using Alfateam.Database.Models.Promotions
@{
    Layout = "_AdminLayout";
}
@model Promotion

<!-- Page Heading -->
<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">
            Создание нового тарифной карточки
        </h1>
    </div>
</div>
<!-- /.row -->

<div class="row">
    <div class="col-lg-12">

        <form asp-action="CreatePromotionPOST" asp-controller="Promotions" method="post" enctype="multipart/form-data" role="form">

            <div class="form-group">
                <label>Заголовок</label>
                <input class="form-control" asp-for="Captions[0].Text" required placeholder="">
            </div>
            <input type="hidden" asp-for="Captions[0].LanguageId" value="1" />

            <div class="form-group">
                <label>Изображение</label>
                <input type="file" name="file" required>
            </div>

            <div class="form-group">
                <label>Описание цены</label>
                <input class="form-control"  asp-for="Prices[0].Text" required placeholder="">
            </div>
            <input type="hidden" asp-for="Prices[0].LanguageId" value="1" />


            <div class="form-group">
                <label>Описания тарифа</label>
                <div class="col-lg-12">
                    <div class="table-responsive">
                        <h4>Заголовок</h4>
                        <button type="button" class="btn btn-primary" onclick="addTitleTranslation()">Добавить пункт</button>
                        <table class="table table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th>Описание</th>
                                    <th style="width:80px"></th>
                                </tr>
                            </thead>
                            <tbody id="titleTranslationsTBody">
                               <tr>
                                   <input type="hidden" name="Descriptions[0].Texts[0].LanguageId" value="1" />
                                   <td><input class="form-control" name="Descriptions[0].Texts[0].Text" required placeholder=""></td>
                                   <td><button type="button" onclick="deleteTitleTranslation(event)" class="btn btn-danger">Удалить</button></td>
                               </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <button type="submit" class="btn btn-default">Создать</button>
        </form>

    </div>
</div>

@*Описания тарифа*@
<script>

    let titleTranslationsIndex = 0;
    
    function addTitleTranslation(){

        titleTranslationsIndex++;
        let tBody = document.getElementById("titleTranslationsTBody");

        let tr = document.createElement("tr");
        tr.innerHTML = `  <input type="hidden" name="Descriptions[${titleTranslationsIndex}].Texts[0].LanguageId" value="1" />
                          <td><input class="form-control" name="Descriptions[${titleTranslationsIndex}].Texts[0].Text" required placeholder=""></td>
                          <td><button type="button" onclick="deleteTitleTranslation(event)" class="btn btn-danger">Удалить</button></td>`;

        tBody.appendChild(tr);

    }

    function deleteTitleTranslation(event) {

         let tBody = document.getElementById("titleTranslationsTBody");
         tBody.removeChild(event.target.parentNode.parentNode);

         titleTranslationsIndex--;
    }

</script>